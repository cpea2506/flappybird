'use strict';class Bird{constructor(a=new Game){this.game=a,this.images=[],this.audios=[],this.played=[,,,,,].fill(!1),this.random=null,this.currentFrame=this.imageIndex=0,this.birds={x:70,y:218,w:34,h:24},this.toTheHeaven=376,this.heavenDone=!1,this.jump=this.speedY=0,this.gravity=.1,this.rotation=0,this.degree=Math.PI/180}init(){this.random=Math.floor(3*Math.random()),this.loadAudio(),this.loadImage()}loadAudio(){const a=new Audio("audio/swoosh.wav"),b=new Audio("audio/wing.wav"),c=new Audio("audio/hit.wav"),d=new Audio("audio/die.wav"),e=new Audio("audio/toTheHeaven.mp3");this.audios.push(a,b,c,d,e)}loadImage(){const a=new Image,b=new Image,c=new Image,d=new Image;switch(this.random){case 0:a.src="img/yellowbird-midflap.webp",b.src="img/yellowbird-downflap.webp",c.src="img/yellowbird-upflap.webp";break;case 1:a.src="img/redbird-midflap.webp",b.src="img/redbird-downflap.webp",c.src="img/redbird-upflap.webp";break;case 2:a.src="img/bluebird-midflap.webp",b.src="img/bluebird-downflap.webp",c.src="img/bluebird-upflap.webp";}d.src="img/deathBird.webp",this.images.push(a,b,c,d)}update(){const a=this.game.state,b=this.game.currentState;b!==a.ready&&(this.currentFrame++,b===a.play&&0==this.currentFrame%5&&(this.imageIndex=++this.imageIndex%3),375>=this.birds.y&&(this.birds.y+=this.speedY+=this.gravity),this.speedY>=this.jump?(this.rotation=90*this.degree,!this.played[0]&&this.audios[0].play()):this.rotation=-25*this.degree),this.death()}flap(){const a=this.game.currentState,b=this.game.state;a===b.ready&&(this.game.currentState=this.game.state.play),this.audios[1].play(),this.speedY=-(this.jump=3)}death(){const a=this.game.pipe.pipes;375<this.birds.y+this.birds.w&&(this.game.currentState=this.game.state.over,!this.played[3]&&(this.audios[3].play(),this.played[3]=!0,this.played[0]=!0));for(let b=0,c=a.length;b<c;b++)if(this.birds.x+this.birds.w>a[b].x&&this.birds.x<a[b].x+a[b].w&&(this.birds.y+this.birds.h>a[b].y||this.birds.y<a[b].y-a[b].gap)){this.played[2]||(this.audios[2].play(),this.played[2]=!0,this.played[0]=!0),this.game.currentState=this.game.state.over;break}}draw(){const a=this.game.currentState,b=this.game.state,c=this.game.offContext,d=this.game.announce.medalDone;a===b.over?(c.save(),c.translate(this.birds.x+17,this.birds.y+12),c.rotate(this.rotation),c.drawImage(this.images[this.imageIndex],-17,-12),c.restore(),375<this.birds.y+this.birds.h&&d&&!this.heavenDone&&(!this.played[4]&&(this.audios[4].play(),this.played[4]=!0),this.toTheHeaven--,c.drawImage(this.images[3],this.birds.x,this.toTheHeaven),-24>this.toTheHeaven&&(this.heavenDone=!0,this.audios[4].pause()))):(c.save(),c.translate(this.birds.x+17,this.birds.y+12),c.rotate(this.rotation),c.drawImage(this.images[this.imageIndex],-17,-12),c.restore())}}
